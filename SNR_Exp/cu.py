import pandas as pd

df = pd.read_excel('明星 记录数：55654 用户数：36615 发文用户数：121.xlsx')

df.columns = ['序号', '发文/转发时间(2022年1月1日至今)', '发文/转发用户ID', '发文/转发用户昵称',
              '发文/转发内容ID', '发文/转发内容', '发文/转发标识',
              '发文用户粉丝数', '转发/评论时间(2022年1月1日至今)', '转发/评论用户ID',
              '转发/评论用户昵称', '转发/评论ID', '转发/评论内容', '转发/评论标识',
              '评论数', '点赞数', '转发数']

# 查询的用户ID集合
set_of_user = {
    5063345915560605,
    5063359327897226,
    5063240016987117,
    5062021664211749,
    5063323304068139,
    5063317721454296,
    5063376795342496,
    5062279995332361,
    5062969878124634,
    5063368626935268,

    5063377203758273,
    5063616619872944,
    5063618274003849,
    5063270416779038,
    5063601168322514,

    5062169639261375,
    5063419407369435,
    5063014988913878,
    5063218571248011,
    5063316702233185,

    5063235717566849,
    5063304021807461,
    5063065563562585,
    5063346875010369,
    5062274430278148,

    5062988840831658,
    5063421659192518,
    5063053312005714,
    5063305958002350,
    5063028254970210,

    5062882021344654,
    5062644728337865,
    5063329838272239,
    5063357388293010,
    5062979722414627,

    5062678269136275,
    5063438281474747,
    5062517153600835,
    5063024082162850,
    5062069768684422,

    5063621559977207,
    5062521994347979,
    5063699930811321,
    5062270023370677,
    5062508106748975,

    5061791090477322,
    5062287269037878,
    5062530651918121,
    5062499217179390,
    5063196676981095,

    5063291437060845,
    5062660844687099,
    5063236858938860,
    5063398563774902,
    5062911724880875,


    5063588404268242,
    5062273494681094,
    5062874049545600,
    5062242381335894,
    5062470284869841,


    5062228611433021,
    5063050522788468,
    5063355465207866,
    5063017696072656,
    5062663417102341,


    5061916496497634,
    5062862758215808,
    5062881605059250,
    5063650068404169,
    5063438040570118,


    5061066054178260,
    5062965542523525,
    5062213792960840,
    5063015642957021,
    5063059032775290,
    5063617848020738,
    5062204623161499,
    5062143654757714,
    5062169171334310,
    5063694721747546,

    5061654782150290,
    5062203854033193,
    5063255412179620,
    5063656611774780,
    5063309621723785,

    5062881578058822,
    5062924999068743,
    5062576675750910,
    5063673886281310,
    5063302241583130,

    5063060463551373,
    5061841719399830,
    5062321026107167,
    5062887260030196,
    5063061183926256,

    5063391356391223,
    5063233213301160,
    5063071085366725,
    5063268324606573,
    5062846158738089,

}

# 创建一个集合来存储所有相关用户的转发/评论ID
all_unique_comments = set()
print(len(set_of_user))
# 遍历DataFrame，筛选出用户ID集合中的用户，并统计转发/评论ID
for index, row in df.iterrows():
    if row['发文/转发内容ID'] in set_of_user:
        comment_id = row['转发/评论用户ID']
        if not pd.isnull(comment_id):
            all_unique_comments.add(comment_id)  # 自动去重

# 打印结果
print(f"用户ID集合: {set_of_user} 的独特转发/评论ID数量（去重后）:")
print(len(all_unique_comments))
